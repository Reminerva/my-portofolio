<!DOCTYPE html>
<html lang=""en>
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content = "width=device-width, initial-scale=1.0">
        <title>Reksa Alamsyah - Machine Learning Clustering</title>
        <link rel="stylesheet" href="./styles/style.css">
        <link rel="stylesheet" href="./styles/responsive.css">
        <style>
            .flip-horizontal {
                transform: scaleX(-1);
            }
        </style>
    </head>

    <body>
        <!-- Header -->
        <header>
            <div class="main-container">
                <div class="nav">
                    <div class="logo">
                        <a href="./index.html">RA</a>
                    </div>

                    <nav>
                        <ul>
                            <li><a href="#overview">Overview</a></li>
                            <li><a href="#dataset">Dataset</a></li>
                            <li><a href="#clustering">Clustering</a></li>
                            <li><a href="#classification">Classification</a></li>
                            <ri>
                                <a href=./index.html#portfolios>
                                    <button class="btn">Back</button>
                                </a>
                            </ri>
                        </ul>
                    </nav>

                    <div class="burger">
                            <div class="line-1"></div>
                            <div class="line-2"></div>
                            <div class="line-3"></div>
                    </div>
                </div>
            </div>
        </header>

        <section id="overview">
            <div class="ml-clustering main-container">
                <div class="ml-clustering-container">
                    <h3 class="pre-title">Section One</h3>
                    <h1 class="section-title ml-clustering-title"><span>Project</span> Overview</h1>

                    <p>The following page is a deployment/visualization of clustering and classification project results based on the web. This project aims to fulfill the final assignment of the Dicoding course by meeting six criteria, which include:</p>
                    <div class="ml-clustering-list">
                        <ul>
                            <li>Criterion 1: Using the Provided Notebook Template</li>
                            <li>Criterion 2: Selecting Dataset Columns</li>
                            <li>Criterion 3: Achieving a Minimum Silhouette Score of 0.55 in Final Clustering Evaluation</li>
                            <li>Criterion 4: Writing a Detailed Cluster Interpretation</li>
                            <li>Criterion 5: Using Dataset and Labels from the Clustering Results</li>
                            <li>Criterion 6: Achieving a Minimum Accuracy and F1-Score of 87% on the Training and Testing Set</li>
                        </ul>
                    </div>
                    <p>
                        The clustering project started with loading the data then followed by Exploratory Data Analysis (include missing value, duplicated data and outliers identification), data preprocessing (include data cleaning and data encoding, standardization & normalization), Clustering Model Development (include feature selection with grid search, model selection and model evaluation) and Cluster Visualization. The final evaluation of the model indicated a good performance, achieving a silhouette score about 59%. The data labeled with the cluster was then exported to a CSV file. The file is then used for the classification project.
                    </p>
                    <p>
                        The classification project began with loading the file then followed by data splitting (7:3), Classification Model Development (with Random Forest), Hyperparameter Tuning with grid search, and Model Evaluation. It turns out that the model's performance was poor, with very low accuracy and F1 score. Undersampling and Oversampling was used to handle the problem. The last evaluation of the model showed that the model's performance was good, with accuracy and F1 score above 90%.
                    </p>
                    <p>
                        As explained earlier, this page only presents the results and its visualizations of the clustering and classification project. For more details, you can access it through the following link: <a href="https://colab.research.google.com/drive/1tdM-yxUORcr0uFa9mHUUVdXvh4at66vG?usp=sharing" target="_blank">Machine Learing for Clustering</a>, <a href="https://colab.research.google.com/drive/1LUEx9_auUQL-RJRGrgqkboWwJ2pK2Byk?usp=sharing" target="_blank">Machine Learing for Classification</a>
                    </p>
                </div>
                
            </div>
        </section>

        <section id="dataset">
            <div class="ml-clustering main-container">
                <div class="ml-clustering-container">
                    <h3 class="pre-title">Section Two</h3>
                    <h1 class="section-title ml-clustering-title">The <span>Dataset</span></h1>
                    <h2 class="sub-header">Customer Personality Analysis <span>Dataset</span></h2>
                    
                    <hr>
                    
                    <p>Customer Personality Analysis is an in-depth analysis of the ideal customers for a company. It helps businesses better understand their customers and enables them to tailor products according to the specific needs, behaviors, and interests of different customer types.</p>
                    <p>Customer personality analysis allows businesses to adjust their products based on the target customers from various segments. For example, instead of spending money marketing a new product to all customers in the company's database, the company can analyze which customer segments are most likely to purchase the product and then market it only to that segment.</p>
                    <p>This dataset was chosen from the "Suggested Dataset Sources" in the Machine Learning Project Submission.</p>
                    <p>Number of rows: 2240 | Number of columns: 29 | Dataset Source: <a href="https://www.kaggle.com/datasets/imakash3011/customer-personality-analysis">Dataset Link (Kaggle)</a></a></p>
                    <p>Here the details of every column:</p>
                    <div class="ml-clustering-list">
                        <ul>
                            <li>1. ID: Customer’s unique identifier</li>
                            <li>2. Year_Birth: Customer's birth year</li>
                            <li>3. Education: Education Qualification of customer</li>
                            <li>4. Marital_Status: Marital Status of customer</li>
                            <li>5. Income: Customer's yearly household income</li>
                            <li>6. Kidhome: Number of children in customer's household</li>
                            <li>7. Teenhome: Number of teenagers in customer's household</li>
                            <li>8. Dt_Customer: Date of customer's enrollment with the company</li>
                            <li>9. Recency: Number of days since customer's last purchase</li>
                            <li>10. Complain: 1 if the customer complained in the last 2 years, 0 otherwise</li>
                            <li>11. MntWines: Amount spent on wine in last 2 years</li>
                            <li>12. MntFruits: Amount spent on fruits in last 2 years</li>
                            <li>13. MntMeatProducts: Amount spent on meat in last 2 years</li>
                            <li>14. MntFishProducts: Amount spent on fish in last 2 years</li>
                            <li>15. MntSweetProducts: Amount spent on sweets in last 2 years</li>
                            <li>16. MntGoldProds: Amount spent on gold in last 2 years</li>
                            <li>17. NumDealsPurchases: Number of purchases made with a discount</li>
                            <li>18. AcceptedCmp1: 1 if customer accepted the offer in the 1st campaign, 0 otherwise</li>
                            <li>19. AcceptedCmp2: 1 if customer accepted the offer in the 2nd campaign, 0 otherwise</li>
                            <li>20. AcceptedCmp3: 1 if customer accepted the offer in the 3rd campaign, 0 otherwise</li>
                            <li>21. AcceptedCmp4: 1 if customer accepted the offer in the 4th campaign, 0 otherwise</li>
                            <li>22. AcceptedCmp5: 1 if customer accepted the offer in the 5th campaign, 0 otherwise</li>
                            <li>23. Response: 1 if customer accepted the offer in the last campaign, 0 otherwise</li>
                            <li>24. NumWebPurchases: Number of purchases made through the company’s website</li>
                            <li>25. NumCatalogPurchases: Number of purchases made using a catalogue</li>
                            <li>26. NumStorePurchases: Number of purchases made directly in stores</li>
                            <li>27. NumWebVisitsMonth: Number of visits to company’s website in the last month</li>
                            <li>28. Z_CostContact</li>
                            <li>29. Z_Revenue</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section id="clustering">
            <div class="ml-clustering main-container">
                <div class="ml-clustering-container">

                    <h3 class="pre-title">Section Three</h3>
                    <h1 class="section-title ml-clustering-title"><span>Clustering</span></h1>
                    
                    <h2 class="sub-header">Modeling <span>without</span> Feature Selection</h2>
                
                    <hr>

                    <p>In this project, two models were selected, namely DBSCAN and K-Means, to be tested without prior feature selection. The evaluation results using silhouette score were 0.590 (K-Means) and 0.22 (DBSCAN).</p>
                    <div class="ml-clustering-images">
                        <img class="img_2" src="./images/images_clust/Picture1.png" alt="">
                    </div>
                    <p>The K-Means model shows good performance, but the issue is that it uses too many features, which can make interpreting the clustering results more difficult. It means the features selection was needed.</p>

                    <h2 class="sub-header">Modeling <span>with</span> Feature Selection</h2>

                    <hr>

                    <p>To solve the issue, Correlation Matrix was used to show which features has the most significant correlation to each other.</p>
                    <div class="ml-clustering-images">
                        <img class="img_1" class="img_1" src="./images/images_clust/Picture2.png" alt="">
                    </div>
                    <p>Based on the correlation matrix, 16 features are considered, with 5 or 6 to be selected for model training. Here are the 16 features:</p>
                    <div class="ml-clustering-list">
                        <ul>
                            <li>Year_Birth</li>
                            <li>Education</li>
                            <li>Income</li>
                            <li>MntWines</li>
                            <li>MntFruits</li>
                            <li>MntMeatProducts</li>
                            <li>MntFishProducts</li>
                            <li>MntSweetProducts</li>
                            <li>MntGoldProds</li>
                            <li>NumWebPurchases</li>
                            <li>NumCatalogPurchases</li>
                            <li>NumStorePurchases</li>
                            <li>Kidhome</li>
                            <li>NumWebVisitsMonth</li>
                            <li>Marital_Status</li>
                            <li>Response</li>
                        </ul>
                    </div>
                    <p>Since we select 5 or 6 out of 16, It will take so much times if we select them manually.</p>
                    <p>Mathematically, if we selected 5 out of 16 features, we will need C_16^5=16!/(16-5)!5!=4368 trial to find the best 5 features (globally optimal) and C_16^6=16!/(16-6)!6!=8008 trial for the best 6 features selection. From here, the grid search was used to find the best 5 or 6 features, since 8008 trial was considered as ‘not a really big number’ to do the grid search.</p>
                    <p>The grid search applied to K-Means clustering showed that the best 5 features were MntFruits, MntMeatProducts, MntFishProducts, MntSweetProducts, and Response, with a total of 3 clusters and a 0.593 silhouette score. This was better than the first K-Means model, where feature selection was not applied, because the second model had less features and better Silhouette Score. </p>
                    <p>In contrast, the best 6 features, MntFruits, MntMeatProducts, MntFishProducts, MntSweetProducts, MntGoldProds, and Response, produced 5 clusters with a silhouette score of 0.522, which doesn’t meet the minimum silhouette score requirements and was worse than the model with the best 5 features. It means </p>
                    <p>DBSCAN was not used in this case due to the extensive time required for feature selection and hyperparameter tuning. Since the DBSCAN and K-Means models with the best 6 features were not used, the only remaining option is the K-Means model with the best 5 features.</p>

                    <h2 class="sub-header">Cluster <span>Visualization</span></h2>
                    
                    <hr>

                    <p>The K-Means with best 5 features was visualized with matplotlib. Here is the visualization:</p>
                    <div class="ml-clustering-images">
                        <img class="img_1" src="./images/images_clust/Picture3.png" alt="">
                    </div>

                    <h2 class="sub-header">Cluster <span>Interpretation</span></h2>
                    <hr>
                    <p>Here is the conclusion of the cluster interpretation. To see more detailed process of this part, visit the google colab link: <a href="https://colab.research.google.com/drive/1tdM-yxUORcr0uFa9mHUUVdXvh4at66vG?usp=sharing">Machine Learing for Clustering</a></p>
                    
                    <div class="ml-interpret-list">
                        <h4>Features:</h4>
                        <div class="ml-clustering-list">
                            <ul>
                                <li><span>MntFruits: </span>Amount spent on fruits in the last 2 years</li>
                                <li><span>MntMeatProducts: </span>Amount spent on meat in the last 2 years</li>
                                <li><span>MntFishProducts: </span>Amount spent on fish in the last 2 years</li>
                                <li><span>MntSweetProducts: </span>Amount spent on sweets in the last 2 years</li>
                                <li><span>Response: </span>1 if the customer accepted the offer in the last campaign, 0 otherwise</li>
                            </ul>
                        </div>
                    </div>

                    <div class="ml-interpret-list">
                        <h4>Cluster 0:</h4>
                        <div class="ml-clustering-list">
                            <ul>
                                <li>Customers in Cluster 0 have moderate spending on fruits.</li>
                                <li>Customers in Cluster 0 have moderate spending on meat products.</li>
                                <li>Customers in Cluster 0 have low spending on fish products.</li>
                                <li>Customers in Cluster 0 have moderate spending on sweet products.</li>
                                <li>It can be interpreted that customers in Cluster 0 are more likely to respond with "False" for "Response."</li>
                            </ul>
                        </div>
                    </div>

                    <div class="ml-interpret-list">
                        <h4>Cluster 1:</h4>
                        <div class="ml-clustering-list">
                            <ul>
                                <li>Customers in Cluster 1 have low spending on fruits.</li>
                                <li>Customers in Cluster 1 have low spending on meat products.</li>
                                <li>Customers in Cluster 1 have moderate spending on fish products.</li>
                                <li>Customers in Cluster 1 have low spending on sweet products.</li>
                            </ul>
                        </div>
                    </div>

                    <div class="ml-interpret-list">
                        <h4>Cluster 2:</h4>
                        <div class="ml-clustering-list">
                            <ul>
                                <li>Customers in Cluster 2 have high spending on fruits.</li>
                                <li>Customers in Cluster 2 have high spending on meat products.</li>
                                <li>Customers in Cluster 2 have high spending on fish products.</li>
                                <li>Customers in Cluster 2 have high spending on sweet products.</li>
                                <li>It can be interpreted that customers in Cluster 2 are more likely to respond with "True" for "Response."</li>
                            </ul>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <section id="classification">
            <div class="ml-clustering main-container">
                <div class="ml-clustering-container">
                    <h3 class="pre-title">Section Four</h3>
                    <h1 class="section-title ml-clustering-title"><span>Classification</span></h1>
                    
                    <h2 class="sub-header">Modeling <span>without</span> Hyperparameter Tuning</h2>

                    <hr>

                    <p>The labeled data with cluster numbers was exported for use in the ML-Classification project. The model used in this project is the Random Forest Classifier. Initially, the data was split into a 70:30 ratio. The 70% portion was then used to train the model with default hyperparameters. The model's performance is as follows:</p>
                    <div class="ml-clustering-images">
                        <img class="img_2" src="./images/images_clust/Picture4.png" alt="">
                    </div>

                    <h2 class="sub-header">Modeling <span>with</span> Hyperparameter Tuning</h2>

                    <hr>

                    <p>The model appears to exhibit overfitting, as it performs well on the training data but significantly worse on the testing data. To address this issue, Hyperparameter Tuning was conducted. Grid Search was chosen as the Hyperparameter Tuning algorithm for this project. The following parameter grid was considered:</p>
                    <div class="ml-clustering-images">
                        <img class="img_2" src="./images/images_clust/Picture5.png" alt="">
                    </div>
                    <p>After completing hyperparameter tuning, the best model was selected and its performance evaluated. Below is a comparison of the model's performance before and after hyperparameter tuning:</p>
                    <div class="ml-clustering-images">
                        <img class="img_2" src="./images/images_clust/Picture6.png" alt="">
                    </div>

                    <h2 class="sub-header">Modeling <span>after</span> Oversampling and Undersampling</h2>

                    <hr>

                    <p>The model after hyperparameter tuning appears to exhibit underfitting, as indicated by poor performance on both the training and testing data. To address this issue, Oversampling and Undersampling methods were applied. Once these methods were implemented, the model was trained both with and without hyperparameter tuning. Below is a comparison of the model's performance before and after hyperparameter tuning.</p>
                    <div class="ml-clustering-images">
                        <img class="img_2" src="./images/images_clust/Picture7.png" alt="">
                    </div>
                </div>
            </div>
        </section>
                
    </body>
</html>